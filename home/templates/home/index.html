{% extends "base.html" %}
{% load static %}
{% block title %}
  Home | The Elysium Archive
{% endblock title %}
{% block content %}
  <section class="container py-5">
    <div class="row g-4 align-items-center">
      <!-- Hero section -->
      <div class="col-12 col-lg-5">
        <div class="panel p-4 text-center hero-panel">
          <h1 class="display-5 mb-3">The Elysium Archive</h1>
          <p class="muted mb-4">
            A forbidden archive reserved for invited members only. Unlock entries and read them online forever.
          </p>
          <!-- Loop intro video -->
          <div class="video-wrapper mb-3">
            <video class="video w-100"
                   autoplay
                   loop
                   muted
                   playsinline
                   preload="metadata"
                   data-hero-video
                   aria-label="A looping corridor entrance video">
              <source src="{% static 'video/elysium-intro-video.mp4' %}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="d-grid gap-2">
            <a class="btn btn-primary" href="{% url 'archive' %}">Browse the Archive</a>
            <a class="btn btn-outline-light" href="#membership">Become a Member</a>
          </div>
          <button class="btn btn-link effects-toggle mt-2"
                  type="button"
                  id="effectsToggle"
                  aria-pressed="false">Reduce effects</button>
          <p class="small muted mt-3 mb-0">No downloads. No external files. Access is the product.</p>
        </div>
      </div>
      <!-- Archive entries -->
      <div class="col-12 col-lg-7">
        <div class="section-header mb-3" id="archives">
          <div class="section-header-text">
            <h2 class="h3 mb-1 section-title">Archive Entries</h2>
            <p class="small muted mb-0">A rotating selection of sealed previews from the public catalog.</p>
          </div>
          <!-- Mobile navigation -->
          <div class="section-header-actions d-md-none">
            <button class="btn btn-sm btn-outline-light section-nav-btn"
                    type="button"
                    data-bs-target="#entryCarouselMobile"
                    data-bs-slide="prev"
                    aria-label="Previous preview entries">‹</button>
            <button class="btn btn-sm btn-outline-light section-nav-btn"
                    type="button"
                    data-bs-target="#entryCarouselMobile"
                    data-bs-slide="next"
                    aria-label="Next preview entries">›</button>
          </div>
          <!-- Tablet navigation -->
          <div class="section-header-actions d-none d-md-flex d-xl-none">
            <button class="btn btn-sm btn-outline-light section-nav-btn"
                    type="button"
                    data-bs-target="#entryCarouselTablet"
                    data-bs-slide="prev"
                    aria-label="Previous preview entries">‹</button>
            <button class="btn btn-sm btn-outline-light section-nav-btn"
                    type="button"
                    data-bs-target="#entryCarouselTablet"
                    data-bs-slide="next"
                    aria-label="Next preview entries">›</button>
          </div>
          <!-- Desktop navigation -->
          <div class="section-header-actions d-none d-xl-flex">
            <button class="btn btn-sm btn-outline-light section-nav-btn"
                    type="button"
                    data-bs-target="#entryCarouselDesktop"
                    data-bs-slide="prev"
                    aria-label="Previous preview entries">‹</button>
            <button class="btn btn-sm btn-outline-light section-nav-btn"
                    type="button"
                    data-bs-target="#entryCarouselDesktop"
                    data-bs-slide="next"
                    aria-label="Next preview entries">›</button>
          </div>
        </div>
        <div class="panel p-3 p-lg-4">
          <!-- Mobile carousel (1 card per slide) -->
          <div id="entryCarouselMobile"
               class="carousel slide entry-carousel d-md-none"
               data-bs-ride="false"
               data-bs-touch="true">
            <div class="carousel-inner">
              {% for product in featured_products %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                  <article class="entry-card entry-card--carousel">
                    <div class="entry-card-media">
                      {% if product.image %}
                        <img class="entry-card-img"
                             src="{{ product.image.url }}"
                             alt="{{ product.image_alt }}"
                             loading="lazy">
                      {% else %}
                        <div class="entry-card-img-placeholder"></div>
                      {% endif %}
                    </div>
                    <div class="entry-card-body">
                      <div class="entry-card-head d-flex align-items-start justify-content-between gap-3">
                        <div>
                          <p class="small muted text-uppercase mb-1">Archive Entry {{ forloop.counter }}</p>
                          <h3 class="h6 mb-0 lh-sm">{{ product.title }}</h3>
                        </div>
                        <span class="badge badge-sealed align-self-start">Sealed</span>
                      </div>
                      <p class="small muted mb-0">{{ product.tagline }}</p>
                    </div>
                    <div class="entry-card-footer">
                      <span class="price">€{{ product.price }}</span>
                      <a class="btn btn-sm btn-outline-light" href="{% url 'archive' %}">View Entry</a>
                    </div>
                  </article>
                </div>
              {% endfor %}
            </div>
            <!-- Mobile indicators -->
            <div class="carousel-indicators entry-carousel-dots position-static mt-3 mb-0">
              {% for product in featured_products %}
                <button type="button"
                        data-bs-target="#entryCarouselMobile"
                        data-bs-slide-to="{{ forloop.counter0 }}"
                        {% if forloop.first %}class="active" aria-current="true"{% endif %}
                        aria-label="Slide {{ forloop.counter }}"></button>
              {% endfor %}
            </div>
          </div>
          <!-- Tablet carousel (2 cards per slide) -->
          <div id="entryCarouselTablet"
               class="carousel slide entry-carousel d-none d-md-block d-xl-none"
               data-bs-ride="false"
               data-bs-touch="true">
            <div class="carousel-inner">
              {% for product in featured_products %}
                {% if forloop.first or forloop.counter0|divisibleby:2 %}
                  <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="entry-carousel-grid entry-carousel-grid--tablet">
                    {% endif %}
                    <article class="entry-card entry-card--carousel">
                      <div class="entry-card-media">
                        {% if product.image %}
                          <img class="entry-card-img"
                               src="{{ product.image.url }}"
                               alt="{{ product.image_alt }}"
                               loading="lazy">
                        {% else %}
                          <div class="entry-card-img-placeholder"></div>
                        {% endif %}
                      </div>
                      <div class="entry-card-body">
                        <div class="entry-card-head d-flex align-items-start justify-content-between gap-3">
                          <div>
                            <p class="small muted text-uppercase mb-1">Archive Entry {{ forloop.counter }}</p>
                            <h3 class="h6 mb-0 lh-sm">{{ product.title }}</h3>
                          </div>
                          <span class="badge badge-sealed align-self-start">Sealed</span>
                        </div>
                        <p class="small muted mb-0">{{ product.tagline }}</p>
                      </div>
                      <div class="entry-card-footer">
                        <span class="price">€{{ product.price }}</span>
                        <a class="btn btn-sm btn-outline-light" href="{% url 'archive' %}">View Entry</a>
                      </div>
                    </article>
                    {% if forloop.counter|divisibleby:2 or forloop.last %}
                    </div>
                  </div>
                {% endif %}
              {% endfor %}
            </div>
            <!-- Tablet indicators -->
            <div class="carousel-indicators entry-carousel-dots position-static mt-3 mb-0">
              {% for product in featured_products %}
                {% if forloop.first or forloop.counter0|divisibleby:2 %}
                  <button type="button"
                          data-bs-target="#entryCarouselTablet"
                          data-bs-slide-to="{% widthratio forloop.counter0 2 1 %}"
                          {% if forloop.first %}class="active" aria-current="true"{% endif %}
                          aria-label="Slide {% widthratio forloop.counter 2 1 %}"></button>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          <!-- Desktop carousel (3 cards per slide) -->
          <div id="entryCarouselDesktop"
               class="carousel slide entry-carousel d-none d-xl-block"
               data-bs-ride="false"
               data-bs-touch="true">
            <div class="carousel-inner">
              {% for product in featured_products %}
                {% if forloop.first or forloop.counter0|divisibleby:3 %}
                  <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="entry-carousel-grid">
                    {% endif %}
                    <article class="entry-card entry-card--carousel">
                      <div class="entry-card-media">
                        {% if product.image %}
                          <img class="entry-card-img"
                               src="{{ product.image.url }}"
                               alt="{{ product.image_alt }}"
                               loading="lazy">
                        {% else %}
                          <div class="entry-card-img-placeholder"></div>
                        {% endif %}
                      </div>
                      <div class="entry-card-body">
                        <div class="entry-card-head d-flex align-items-start justify-content-between gap-3">
                          <div>
                            <p class="small muted text-uppercase mb-1">Archive Entry {{ forloop.counter }}</p>
                            <h3 class="h6 mb-0 lh-sm">{{ product.title }}</h3>
                          </div>
                          <span class="badge badge-sealed align-self-start">Sealed</span>
                        </div>
                        <p class="small muted mb-0">{{ product.tagline }}</p>
                      </div>
                      <div class="entry-card-footer">
                        <span class="price">€{{ product.price }}</span>
                        <a class="btn btn-sm btn-outline-light" href="{% url 'archive' %}">View Entry</a>
                      </div>
                    </article>
                    {% if forloop.counter|divisibleby:3 or forloop.last %}
                    </div>
                  </div>
                {% endif %}
              {% endfor %}
            </div>
            <!-- Desktop indicators -->
            <div class="carousel-indicators entry-carousel-dots position-static mt-3 mb-0">
              {% for product in featured_products %}
                {% if forloop.first or forloop.counter0|divisibleby:3 %}
                  <button type="button"
                          data-bs-target="#entryCarouselDesktop"
                          data-bs-slide-to="{% widthratio forloop.counter0 3 1 %}"
                          {% if forloop.first %}class="active" aria-current="true"{% endif %}
                          aria-label="Slide {% widthratio forloop.counter 3 1 %}"></button>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          <p class="small muted mt-3 mb-0">
            These are public previews. Full entries unlock after membership and a successful payment.
          </p>
        </div>
      </div>
    </div>
    <!-- How access works -->
    <div class="py-5" id="how-access-works">
      <h2 class="text-center mb-4">How Access Works</h2>
      <div class="row g-3">
        <div class="col-12 col-md-4">
          <div class="panel p-4 h-100 how-card">
            <img class="how-card-img"
                 src="{% static 'img/home/how/how-01-account.jpg' %}"
                 alt="Creating an account"
                 loading="lazy">
            <h3 class="h5 mt-3">Create an account</h3>
            <p class="muted mb-0">Register to become a member and unlock purchases to your profile.</p>
          </div>
        </div>
        <div class="col-12 col-md-4">
          <div class="panel p-4 h-100 how-card">
            <img class="how-card-img"
                 src="{% static 'img/home/how/how-02-seal.jpg' %}"
                 alt="Sealed archive entry"
                 loading="lazy">
            <h3 class="h5 mt-3">Unlock archive entries</h3>
            <p class="muted mb-0">Pay once via Stripe and the entry becomes yours permanently.</p>
          </div>
        </div>
        <div class="col-12 col-md-4">
          <div class="panel p-4 h-100 how-card">
            <img class="how-card-img"
                 src="{% static 'img/home/how/how-03-library.jpg' %}"
                 alt="Private archive library"
                 loading="lazy">
            <h3 class="h5 mt-3">Access your private archive</h3>
            <p class="muted mb-0">Read exclusive content online only, anytime you return.</p>
          </div>
        </div>
      </div>
    </div>
    <!-- Membership -->
    <div class="py-5" id="membership">
      <div class="panel p-4 p-lg-5">
        <div class="row g-4 align-items-center">
          <div class="col-12 col-lg-5">
            <div class="membership-media">
              <img class="membership-img"
                   src="{% static 'img/home/membership/membership.jpg' %}"
                   alt="Membership access"
                   loading="lazy">
            </div>
          </div>
          <div class="col-12 col-lg-7">
            <h2 class="h3 mb-3">Membership</h2>
            <p class="muted mb-3">Membership is required to unlock entries. Your access is tied to your account, not to a file.</p>
            <ul class="mb-4">
              <li class="muted">Buy once, access forever on site</li>
              <li class="muted">Unlocked entries live in your private archive</li>
              <li class="muted">Verified buyers can leave reviews</li>
              <li class="muted">No refunds after access is unlocked</li>
            </ul>
            <div class="panel p-4">
              <div class="d-flex justify-content-between align-items-start gap-2 mb-2">
                <h3 class="h5 mb-0">Ready to enter?</h3>
                <span class="badge text-bg-secondary">Coming next</span>
              </div>
              <p class="muted mb-3">Register and login will be enabled in the Accounts milestone.</p>
              <div class="d-grid gap-2 d-sm-flex">
                <a class="btn btn-primary site-auth-btn disabled"
                   href="#"
                   aria-disabled="true"
                   tabindex="-1">Register</a>
                <a class="btn btn-outline-light site-auth-btn disabled"
                   href="#"
                   aria-disabled="true"
                   tabindex="-1">Login</a>
              </div>
              <p class="small muted mt-3 mb-0">You can browse the public catalog without an account.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
{% endblock content %}
{% block extra_js %}
  <script src="{% static 'js/effects-toggle.js' %}" defer></script>
{% endblock extra_js %}
